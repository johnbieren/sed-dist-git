---
- hosts: localhost
  vars:
    artifacts: ./artifacts
  vars_prompt:
  - name: subjects
    prompt: "Folder containing QCow2/raw test subject"
    private: no
  tasks:
  - name: Install the test requirements
    package: name={{item}} state=latest
    with_items:
    - beakerlib
    - genisoimage
    - qemu-system-x86

  - name: Run the local playbook in a launched instance
    qemu_playbook:
      subjects: "{{subjects}}"
      playbook: "test_local.yml"
      log: "{{artifacts}}/machine.log"
